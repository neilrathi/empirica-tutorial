{"version":3,"sources":["../src/player/classic/react/EmpiricaContext.tsx","../src/player/classic/react/Lobby.tsx","../src/player/classic/react/hooks.ts","../src/player/classic/react/Steps.tsx","../src/player/classic/react/Quiz.tsx","../src/player/classic/react/Slider.tsx","../src/player/classic/react/chat/Chat.tsx","../src/player/classic/react/examples/Sweeper.tsx"],"sourcesContent":["import React from \"react\";\nimport { Consent, ConsentProps } from \"../../react/Consent\";\nimport { Finished } from \"../../react/Finished\";\nimport { Loading } from \"../../react/Loading\";\nimport { NoGames } from \"../../react/NoGames\";\nimport { PlayerCreate, PlayerCreateProps } from \"../../react/PlayerCreate\";\nimport {\n  useConsent,\n  useGlobal,\n  usePartConnected,\n  usePlayerID,\n  useTajribaConnected,\n} from \"../../react/hooks\";\nimport { Lobby as DefaultLobby } from \"./Lobby\";\nimport { Steps, StepsFunc } from \"./Steps\";\nimport { useGame, usePlayer, useRound, useStage } from \"./hooks\";\n\nexport interface EmpiricaContextProps {\n  children: React.ReactNode;\n  noGames?: React.ElementType;\n  consent?: React.ElementType<ConsentProps>;\n  playerCreate?: React.ElementType<PlayerCreateProps>;\n  lobby?: React.ElementType;\n  introSteps: React.ElementType[] | StepsFunc;\n  exitSteps: React.ElementType[] | StepsFunc;\n  finished?: React.ElementType;\n  loading?: React.ElementType;\n  connecting?: React.ElementType;\n\n  // An unmanaged game will render the children as soon as the Game is available\n  // whether the round or stage are available or not. It is up to the developer\n  // to handle the presence of the round and stage.\n  // Everything else is still managed: the consent, the player, the intro\n  // steps, the lobby, and the game.\n  // This is not recommended for most games.\n  // This is useful for games that want to persist render state between rounds\n  // or stages. E.g. keep a video chat up between stages.\n  unmanagedGame: boolean;\n\n  // Unmanaged assignement will render the children as soon as the player is\n  // connected. It is up to the developer to handle everything after the player\n  // is connected: intro steps, lobby, game, round, stage and exit steps.\n  unmanagedAssignment: boolean;\n\n  // Disable the consent screen. It is up to the developer to handle the consent\n  // screen.\n  disableConsent: boolean;\n\n  // Disable the NoGames screen. It is up to the developer to handle the NoGames\n  // condition.\n  disableNoGames: boolean;\n\n  // Disable capturing URL params (?what=hello&some=thing) onto the Player under\n  // the `urlParams` key.\n  disableURLParamsCapture: boolean;\n}\n\nexport function EmpiricaContext({\n  noGames: NoGamesComp = NoGames,\n  consent: ConsentComp = Consent,\n  playerCreate: PlayerCreateForm = PlayerCreate,\n  introSteps = [],\n  lobby = DefaultLobby,\n  exitSteps = [],\n  finished = Finished,\n  loading: LoadingComp = Loading,\n  connecting: ConnectingComp = Loading,\n  unmanagedGame = false,\n  unmanagedAssignment = false,\n  disableConsent = false,\n  disableNoGames = false,\n  disableURLParamsCapture = false,\n  children,\n}: EmpiricaContextProps) {\n  const tajribaConnected = useTajribaConnected();\n  const participantConnected = usePartConnected();\n  const globals = useGlobal();\n  const player = usePlayer();\n  const game = useGame();\n  const [connecting, hasPlayer, onPlayerID] = usePlayerID();\n  const [consented, onConsent] = useConsent();\n\n  if (!tajribaConnected || connecting) {\n    return <ConnectingComp />;\n  }\n\n  if (player && player.get(\"ended\")) {\n    return <Exit exitSteps={exitSteps} finished={finished} />;\n  }\n\n  if (\n    !globals ||\n    (hasPlayer && (!participantConnected || !player || game === undefined))\n  ) {\n    return <LoadingComp />;\n  }\n\n  if (\n    !disableNoGames &&\n    !globals.get(\"experimentOpen\") &&\n    (!hasPlayer || !player?.get(\"gameID\"))\n  ) {\n    return <NoGamesComp />;\n  }\n\n  if (!disableConsent && !consented) {\n    return <ConsentComp onConsent={onConsent!} />;\n  }\n\n  if (!hasPlayer) {\n    return (\n      <PlayerCreateForm onPlayerID={onPlayerID!} connecting={connecting} />\n    );\n  }\n\n  if (!player || !game) {\n    return <LoadingComp />;\n  }\n\n  // TODO Put in a useEffect, this is dirty.\n  if (!disableURLParamsCapture && !player.get(\"urlParams\")) {\n    const urlParams = new URLSearchParams(window.location.search);\n    player.set(\"urlParams\", Object.fromEntries(urlParams.entries()));\n  }\n\n  if (unmanagedAssignment) {\n    return <>{children}</>;\n  }\n\n  if (game && game.hasEnded) {\n    return <Exit exitSteps={exitSteps} finished={finished} />;\n  }\n\n  return (\n    <Steps progressKey=\"intro\" doneKey=\"introDone\" steps={introSteps}>\n      <EmpiricaInnerContext\n        exitSteps={exitSteps}\n        lobby={lobby}\n        finished={finished}\n        loading={LoadingComp}\n        unmanagedGame={unmanagedGame}\n      >\n        {children}\n      </EmpiricaInnerContext>\n    </Steps>\n  );\n}\n\ninterface EmpiricaInnerContextProps {\n  children: React.ReactNode;\n  lobby: React.ElementType;\n  exitSteps: React.ElementType[] | StepsFunc;\n  finished: React.ElementType;\n  loading: React.ElementType;\n  unmanagedGame: boolean;\n}\n\nfunction EmpiricaInnerContext({\n  children,\n  lobby: Lobby,\n  finished,\n  exitSteps,\n  loading: LoadingComp,\n  unmanagedGame = false,\n}: EmpiricaInnerContextProps) {\n  const game = useGame();\n  const stage = useStage();\n  const round = useRound();\n\n  if (!game) {\n    return <LoadingComp />;\n  }\n\n  if (!Boolean(game.get(\"status\"))) {\n    return <Lobby />;\n  }\n\n  if (game.hasEnded) {\n    return <Exit exitSteps={exitSteps} finished={finished} />;\n  }\n\n  if (!unmanagedGame && (!stage || !round)) {\n    return <LoadingComp />;\n  }\n\n  return <>{children}</>;\n}\n\nfunction Exit({\n  exitSteps,\n  finished: Finished,\n}: {\n  exitSteps: React.ElementType[] | StepsFunc;\n  finished: React.ElementType;\n}) {\n  return (\n    <Steps progressKey=\"exitStep\" doneKey=\"exitStepDone\" steps={exitSteps}>\n      <Finished />\n    </Steps>\n  );\n}\n","import React from \"react\";\nimport { warn } from \"../../../utils/console\";\nimport { Loading } from \"../../react/Loading\";\nimport { usePlayer } from \"./hooks\";\n\nexport function Lobby() {\n  const player = usePlayer();\n\n  if (!player) {\n    return <Loading />;\n  }\n\n  const treatment = player.get(\"treatment\") as { playerCount: number };\n\n  if (!treatment || !treatment.playerCount) {\n    warn(\"lobby: no treatment found on player\");\n\n    return <Loading />;\n  }\n\n  return (\n    <div className=\"flex h-full items-center justify-center\">\n      <div className=\"text-center\">\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          viewBox=\"0 0 640 512\"\n          className=\"mx-auto h-12 w-12 text-gray-400\"\n          stroke=\"none\"\n          fill=\"currentColor\"\n          aria-hidden=\"true\"\n        >\n          <path d=\"M544 224c44.2 0 80-35.8 80-80s-35.8-80-80-80-80 35.8-80 80 35.8 80 80 80zm0-128c26.5 0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48 21.5-48 48-48zM320 256c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm0-192c44.1 0 80 35.9 80 80s-35.9 80-80 80-80-35.9-80-80 35.9-80 80-80zm244 192h-40c-15.2 0-29.3 4.8-41.1 12.9 9.4 6.4 17.9 13.9 25.4 22.4 4.9-2.1 10.2-3.3 15.7-3.3h40c24.2 0 44 21.5 44 48 0 8.8 7.2 16 16 16s16-7.2 16-16c0-44.1-34.1-80-76-80zM96 224c44.2 0 80-35.8 80-80s-35.8-80-80-80-80 35.8-80 80 35.8 80 80 80zm0-128c26.5 0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48 21.5-48 48-48zm304.1 180c-33.4 0-41.7 12-80.1 12-38.4 0-46.7-12-80.1-12-36.3 0-71.6 16.2-92.3 46.9-12.4 18.4-19.6 40.5-19.6 64.3V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-44.8c0-23.8-7.2-45.9-19.6-64.3-20.7-30.7-56-46.9-92.3-46.9zM480 432c0 8.8-7.2 16-16 16H176c-8.8 0-16-7.2-16-16v-44.8c0-16.6 4.9-32.7 14.1-46.4 13.8-20.5 38.4-32.8 65.7-32.8 27.4 0 37.2 12 80.2 12s52.8-12 80.1-12c27.3 0 51.9 12.3 65.7 32.8 9.2 13.7 14.1 29.8 14.1 46.4V432zM157.1 268.9c-11.9-8.1-26-12.9-41.1-12.9H76c-41.9 0-76 35.9-76 80 0 8.8 7.2 16 16 16s16-7.2 16-16c0-26.5 19.8-48 44-48h40c5.5 0 10.8 1.2 15.7 3.3 7.5-8.5 16.1-16 25.4-22.4z\" />\n        </svg>\n        <h3 className=\"mt-2 text-sm font-medium text-gray-900\">\n          {treatment.playerCount > 1\n            ? \"Waiting for other players\"\n            : \"Game loading\"}\n        </h3>\n        <p className=\"mt-1 text-sm text-gray-500\">\n          Please wait for the game to be ready.\n        </p>\n      </div>\n    </div>\n  );\n}\n","import { useEffect, useRef, useState } from \"react\";\nimport { BehaviorSubject, Observable, Subscription } from \"rxjs\";\nimport { ParticipantModeContext } from \"../../context\";\nimport { useParticipantContext } from \"../../react/hooks\";\nimport type { StepTick } from \"../../steps\";\nimport { EmpiricaClassicContext, Game, Player, Round, Stage } from \"../classic\";\n\nexport function usePlayer() {\n  return usePartModeCtxKey<EmpiricaClassicContext, \"player\", Player | null>(\n    \"player\"\n  );\n}\n\nexport function useGame() {\n  return usePartModeCtxKey<EmpiricaClassicContext, \"game\", Game | null>(\"game\");\n}\n\nexport function useRound() {\n  return usePartModeCtxKey<EmpiricaClassicContext, \"round\", Round | null>(\n    \"round\"\n  );\n}\n\nexport function useStage() {\n  return usePartModeCtxKey<EmpiricaClassicContext, \"stage\", Stage | null>(\n    \"stage\"\n  );\n}\n\nexport function useStageTimer() {\n  const stage = useStage();\n\n  const [val, setVal] = useState<{ tick: StepTick | undefined }>({\n    tick: stage?.timer?.current,\n  });\n\n  const timerSubscription = useRef<Subscription | null>(null);\n\n  useEffect(() => {\n    if (!stage || !stage.timer) {\n      return;\n    }\n\n    if (timerSubscription.current === null) {\n      timerSubscription.current = stage.timer.obs().subscribe({\n        next(val) {\n          setVal({ tick: val });\n        },\n      });\n    }\n\n    return () => {\n      timerSubscription?.current?.unsubscribe.bind(timerSubscription.current);\n      timerSubscription.current = null;\n    };\n  }, [stage?.timer]);\n\n  return val.tick;\n}\n\nexport function usePlayers() {\n  return usePartModeCtxKey<EmpiricaClassicContext, \"players\", Player[]>(\n    \"players\"\n  );\n}\n\nexport function usePartModeCtx<M>() {\n  const ctx = useParticipantContext() as ParticipantModeContext<M>;\n  const [mode, setMode] = useState<{ data: M | undefined }>({\n    data: ctx?.mode?.getValue(),\n  });\n\n  useEffect(() => {\n    if (!ctx || !ctx.mode) {\n      return;\n    }\n\n    const sub = ctx.mode.subscribe({\n      next(m) {\n        setMode({ data: m });\n      },\n    });\n\n    return sub.unsubscribe.bind(sub);\n  }, [ctx]);\n\n  return mode.data;\n}\n\nexport function usePartModeCtxKey<M, K extends keyof M, R>(\n  name: K\n): R | undefined {\n  const mode = usePartModeCtx<M>();\n  const iniVal =\n    mode &&\n    ((<unknown>mode[name]) as BehaviorSubject<R | undefined> | undefined);\n  const [val, setVal] = useState<{ data: R | undefined }>({\n    data: iniVal?.getValue(),\n  });\n\n  useEffect(() => {\n    if (!mode) {\n      return;\n    }\n\n    const obs = (<unknown>mode[name]) as Observable<R>;\n\n    const sub = obs.subscribe({\n      next(val) {\n        setVal({ data: val });\n      },\n    });\n\n    return sub.unsubscribe.bind(sub);\n  }, [mode]);\n\n  return val.data;\n}\n","import React, { useEffect, useState } from \"react\";\nimport { Attributable } from \"../../../shared/scopes\";\nimport { error } from \"../../../utils/console\";\nimport { WithChildren } from \"../../react/helpers\";\nimport { Game, Player } from \"../classic\";\nimport { useGame, usePlayer } from \"./hooks\";\n\nexport type StepsFunc = (props: {\n  game?: Game | null;\n  player?: Player | null;\n}) => React.ElementType[] | undefined;\n\nexport type StepsProps = WithChildren<{\n  steps: React.ElementType[] | StepsFunc;\n  progressKey: string;\n  doneKey: string;\n  object?: Attributable;\n}>;\n\nexport function Steps({\n  steps,\n  progressKey,\n  doneKey,\n  object,\n  children,\n}: StepsProps) {\n  let obj: Attributable;\n  const game = useGame();\n  const player = usePlayer();\n  const [stps, setStps] = useState<React.ElementType[]>([]);\n  const [stpsSet, setStpsSet] = useState<boolean>(false);\n\n  useEffect(() => {\n    let s: React.ElementType[];\n    if (typeof steps === \"function\") {\n      s = steps({ game, player })!;\n    } else {\n      s = steps;\n    }\n    setStps(s);\n    setStpsSet(true);\n  }, [steps]);\n\n  useEffect(() => {\n    if (stpsSet && (!stps || stps.length === 0)) {\n      obj.set(doneKey, true);\n    }\n  }, [stps]);\n\n  // Find state receiver\n  if (object) {\n    obj = object;\n  } else if (player) {\n    obj = player;\n  } else {\n    error(\"no receiver and no player in Steps\");\n    return <div>Missing attribute</div>;\n  }\n\n  // Are we already done\n  if (obj.get(doneKey)) {\n    return <>{children}</>;\n  }\n\n  const index = (obj.get(progressKey) as number) || 0;\n\n  const next = () => {\n    if (index + 1 >= stps.length) {\n      obj.set(doneKey, true);\n    } else {\n      obj.set(progressKey, index + 1);\n    }\n  };\n\n  const previous = () => {\n    if (index > 0) {\n      obj.set(progressKey, index - 1);\n    }\n  };\n\n  const Step = stps[index];\n  if (!Step) {\n    return <></>;\n  }\n\n  return <Step index={index} previous={previous} next={next}></Step>;\n}\n","import React, { FormEvent, useState } from \"react\";\n\nexport function Quiz({ next }: { next: () => void }) {\n  const labelClassName = \"block text-sm font-medium text-gray-700 mb-2\";\n  const inputClassName =\n    \"appearance-none block px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-empirica-500 focus:border-empirica-500 sm:text-sm\";\n\n  const [sum, setSum] = useState(\"\");\n  const [horse, setHorse] = useState(\"\");\n\n  function handleSubmit(e: FormEvent) {\n    e.preventDefault();\n\n    if (sum !== \"4\" || horse !== \"white\") {\n      alert(\"Incorrect! Read the instructions and please try again.\");\n    } else {\n      next();\n    }\n  }\n\n  return (\n    <div className=\"flex justify-center\">\n      <div className=\"mt-6 sm:mt-24\">\n        <h3 className=\"text-2xl font-semi-bold text-gray-900\">Quiz</h3>\n        <form className=\"mt-4\" onSubmit={handleSubmit}>\n          <p className=\"mb-5\">\n            <label className={labelClassName}>What is 2+2?</label>\n            <input\n              className={inputClassName}\n              type=\"text\"\n              dir=\"auto\"\n              id=\"sum\"\n              name=\"sum\"\n              placeholder=\"e.g. 3\"\n              value={sum}\n              onChange={(e) => setSum(e.target.value)}\n              autoComplete=\"off\"\n              autoFocus\n              required\n            />\n          </p>\n          <p className=\"mb-5\">\n            <label className={labelClassName}>\n              What color was Napoleon's white horse?\n            </label>\n            <input\n              className={inputClassName}\n              type=\"text\"\n              dir=\"auto\"\n              id=\"horse\"\n              name=\"horse\"\n              placeholder=\"brown\"\n              value={horse}\n              onChange={(e) => setHorse(e.target.value)}\n              autoComplete=\"off\"\n              required\n            />\n          </p>\n\n          <button\n            type=\"submit\"\n            className=\"inline-flex items-center px-4 py-2 border text-sm font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-empirica-500\"\n          >\n            Submit\n          </button>\n        </form>\n      </div>\n    </div>\n  );\n}\n","import React, { ChangeEventHandler, RefObject, useRef } from \"react\";\n\nexport interface SliderProps {\n  value: number;\n  onChange: ChangeEventHandler<HTMLInputElement>;\n  min?: number;\n  max?: number;\n  stepSize?: number;\n  disabled?: boolean;\n}\n\nexport function Slider({\n  value,\n  onChange,\n  min = 0,\n  max = 100,\n  stepSize = 1,\n  disabled = false,\n}: SliderProps) {\n  const noVal = value === null || value === undefined;\n  const val = noVal ? (max - min) / 2 : value;\n  const cls = noVal ? \"slider-thumb-zero\" : \"slider-thumb\";\n  const ref: RefObject<HTMLOutputElement> = useRef(null);\n\n  if (value !== null && ref.current) {\n    const nmin = min ? min : 0;\n    const nmax = max ? max : 100;\n    const newVal = Number(((value - nmin) * 100) / (nmax - nmin));\n\n    ref.current.style.left = `calc(${newVal}% + (${8 - newVal * 0.15}px))`;\n  }\n\n  return (\n    <div className=\"relative w-full\">\n      <input\n        className={cls}\n        type=\"range\"\n        min={min}\n        max={max}\n        step={stepSize}\n        value={val}\n        onChange={onChange}\n        disabled={disabled}\n      />\n      {noVal ? (\n        \"\"\n      ) : (\n        <output\n          ref={ref}\n          className=\"font-mono absolute w-12 h-7 flex items-center justify-center left-1/2 bottom-7 rounded transform -translate-x-1/2 bg-gray-200\"\n        >\n          {value}\n        </output>\n      )}\n    </div>\n  );\n}\n","import React, {\n  FormEvent,\n  KeyboardEvent,\n  MouseEvent,\n  useEffect,\n  useRef,\n  useState,\n} from \"react\";\nimport { Attribute } from \"../../../../shared/attributes\";\nimport { Attributable } from \"../../../../shared/scopes\";\nimport { Loading } from \"../../../react\";\nimport { WithChildren } from \"../../../react/helpers\";\nimport { usePlayer } from \"../hooks\";\n\nexport type ChatProps = WithChildren<{\n  scope: Attributable;\n  attribute: string;\n  loading?: React.ElementType;\n}>;\n\nexport type Message = {\n  text: string;\n  sender: {\n    id: string;\n    name: string;\n    avatar: string;\n  };\n};\n\nexport function Chat({\n  scope,\n  attribute = \"messages\",\n  loading: LoadingComp = Loading,\n}: ChatProps) {\n  const player = usePlayer();\n\n  if (!scope || !player) {\n    return <LoadingComp />;\n  }\n\n  const handleNewMessage = (text: string) => {\n    scope.append(attribute, {\n      text,\n      sender: {\n        id: player!.id,\n        name: player!.get(\"name\") || player!.id,\n        avatar: player!.get(\"avatar\"),\n      },\n    } as Message);\n  };\n\n  const msgs = scope.getAttribute(attribute)?.items || [];\n\n  return (\n    <div className=\"h-full w-full flex flex-col\">\n      <Messages msgs={msgs} />\n\n      <Input onNewMessage={handleNewMessage} />\n    </div>\n  );\n}\n\ntype MessagesProps = WithChildren<{\n  msgs: Attribute[];\n}>;\n\nfunction Messages(props: MessagesProps) {\n  const { msgs } = props;\n  const scroller = useRef<HTMLDivElement>(null);\n  const [msgCount, setMsgCount] = useState(0);\n\n  useEffect(() => {\n    if (!scroller.current) {\n      return;\n    }\n\n    if (msgCount !== msgs.length) {\n      setMsgCount(msgs.length);\n      scroller.current.scrollTop = scroller.current.scrollHeight;\n    }\n  }, [scroller, props, msgCount]);\n\n  if (msgs.length === 0) {\n    return (\n      <div className=\"h-full w-full flex justify-center items-center\">\n        <div className=\"flex flex-col justify-center items-center w-2/3 space-y-2\">\n          <div className=\"w-24 h-24 text-gray-200\">\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              className=\"h-full w-full fill-current\"\n              viewBox=\"0 0 512 512\"\n            >\n              <path d=\"M123.6 391.3c12.9-9.4 29.6-11.8 44.6-6.4c26.5 9.6 56.2 15.1 87.8 15.1c124.7 0 208-80.5 208-160s-83.3-160-208-160S48 160.5 48 240c0 32 12.4 62.8 35.7 89.2c8.6 9.7 12.8 22.5 11.8 35.5c-1.4 18.1-5.7 34.7-11.3 49.4c17-7.9 31.1-16.7 39.4-22.7zM21.2 431.9c1.8-2.7 3.5-5.4 5.1-8.1c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208s-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6c-15.1 6.6-32.3 12.6-50.1 16.1c-.8 .2-1.6 .3-2.4 .5c-4.4 .8-8.7 1.5-13.2 1.9c-.2 0-.5 .1-.7 .1c-5.1 .5-10.2 .8-15.3 .8c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c4.1-4.2 7.8-8.7 11.3-13.5c1.7-2.3 3.3-4.6 4.8-6.9c.1-.2 .2-.3 .3-.5z\" />\n            </svg>\n          </div>\n\n          <h4 className=\"text-gray-700 font-semibold\">No chat yet</h4>\n\n          <p className=\"text-gray-500 text-center\">\n            Send a message to start the conversation.\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-full overflow-auto pl-2 pr-4 pb-2\" ref={scroller}>\n      {msgs.map((msg) => (\n        <MessageComp key={msg.id} attribute={msg} />\n      ))}\n    </div>\n  );\n}\n\ntype MessageProps = WithChildren<{\n  attribute: Attribute;\n}>;\n\nfunction MessageComp({ attribute }: MessageProps) {\n  const msg = attribute.value as Message;\n  const ts = attribute.createdAt;\n\n  let avatar = msg.sender.avatar;\n  if (!avatar) {\n    avatar = `https://avatars.dicebear.com/api/identicon/${msg.sender.id}.svg`;\n  }\n\n  let avatarImage = (\n    <img\n      className=\"inline-block h-9 w-9 rounded-full\"\n      src={avatar}\n      alt={msg.sender.id}\n    />\n  );\n  if (!avatar.startsWith(\"http\")) {\n    avatarImage = (\n      <div className=\"inline-block h-9 w-9 rounded-full\">{avatar}</div>\n    );\n  }\n\n  return (\n    <div className=\"flex items-start my-2\">\n      <div className=\"flex-shrink-0\">{avatarImage}</div>\n      <div className=\"ml-3 text-sm\">\n        <p>\n          <span className=\"font-semibold text-gray-900 group-hover:text-gray-800\">\n            {msg.sender.name}\n          </span>\n\n          <span className=\"pl-2 text-gray-400\">{ts && relTime(ts)}</span>\n        </p>\n        <p className=\"text-gray-900 group-hover:text-gray-800\">{msg.text}</p>\n      </div>\n    </div>\n  );\n}\n\ntype InputProps = WithChildren<{\n  onNewMessage: (msg: string) => void;\n}>;\n\nfunction Input({ onNewMessage }: InputProps) {\n  const [text, setText] = useState(\"\");\n\n  const resize = (e: KeyboardEvent<HTMLTextAreaElement>) => {\n    const target = e.target as HTMLTextAreaElement;\n    target.style.height = \"inherit\";\n    target.style.height = `${Math.min(target.scrollHeight, 200)}px`;\n  };\n\n  const handleSubmit = (\n    e:\n      | FormEvent<HTMLFormElement>\n      | KeyboardEvent<HTMLTextAreaElement>\n      | MouseEvent<HTMLButtonElement>\n  ) => {\n    e.preventDefault();\n\n    const txt = text.trim();\n    if (txt === \"\") {\n      return;\n    }\n\n    if (txt.length > 1024) {\n      e.preventDefault();\n\n      alert(\"Max message length is 1024\");\n\n      return;\n    }\n\n    onNewMessage(txt);\n    setText(\"\");\n  };\n\n  const handleKeyDown = (e: KeyboardEvent<HTMLTextAreaElement>) => {\n    if (e.key === \"Enter\" && e.shiftKey === false) {\n      handleSubmit(e);\n      resize(e);\n    }\n  };\n\n  const handleKeyUp = (e: KeyboardEvent<HTMLTextAreaElement>) => {\n    resize(e);\n  };\n\n  return (\n    <form\n      className=\"p-2 flex items-strech gap-2 border-t\"\n      onSubmit={handleSubmit}\n    >\n      <textarea\n        name=\"message\"\n        id=\"message\"\n        rows={1}\n        className=\"peer resize-none bg-transparent block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-200 placeholder:text-gray-300 focus:ring-2 focus:ring-inset focus:ring-empirica-500 sm:text-sm sm:leading-6\"\n        placeholder=\"Say something\"\n        onKeyDown={handleKeyDown}\n        onKeyUp={handleKeyUp}\n        value={text}\n        onChange={(e) => setText(e.target.value)}\n      />\n\n      <button\n        type=\"button\"\n        className=\"rounded-md bg-gray-100 w-9 h-9 p-2 text-sm font-semibold text-gray-500 shadow-sm hover:bg-gray-200 hover:text-empirica-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-empirica-500\"\n        onClick={handleSubmit}\n      >\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          className=\"h-full w-full fill-current\"\n          viewBox=\"0 0 512 512\"\n        >\n          <path d=\"M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480V396.4c0-4 1.5-7.8 4.2-10.7L331.8 202.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8 17.7 316.6C7.1 311.3 .3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z\" />\n        </svg>\n      </button>\n    </form>\n  );\n}\n\nfunction relTime(date: Date) {\n  const difference = (new Date().getTime() - date.getTime()) / 1000;\n\n  if (difference < 60) {\n    return `now`;\n  } else if (difference < 3600) {\n    return `${Math.floor(difference / 60)}m`;\n  } else if (difference < 86400) {\n    return `${Math.floor(difference / 3600)}h`;\n  } else if (difference < 2620800) {\n    return `${Math.floor(difference / 86400)} days ago`;\n  } else if (difference < 31449600) {\n    return `${Math.floor(difference / 2620800)} months ago`;\n  } else {\n    return `${Math.floor(difference / 31449600)} years ago`;\n  }\n}\n\n// function getRelativeTimeString(\n//   date: Date | number,\n//   lang = navigator.language\n// ): string {\n//   // Allow dates or times to be passed\n//   const timeMs = typeof date === \"number\" ? date : date.getTime();\n\n//   // Get the amount of seconds between the given date and now\n//   const deltaSeconds = Math.round((timeMs - Date.now()) / 1000);\n\n//   // Array reprsenting one minute, hour, day, week, month, etc in seconds\n//   const cutoffs = [\n//     60,\n//     3600,\n//     86400,\n//     86400 * 7,\n//     86400 * 30,\n//     86400 * 365,\n//     Infinity,\n//   ];\n\n//   // Array equivalent to the above but in the string representation of the units\n//   const units: Intl.RelativeTimeFormatUnit[] = [\n//     \"second\",\n//     \"minute\",\n//     \"hour\",\n//     \"day\",\n//     \"week\",\n//     \"month\",\n//     \"year\",\n//   ];\n\n//   // Grab the ideal cutoff unit\n//   const unitIndex = cutoffs.findIndex(\n//     (cutoff) => cutoff > Math.abs(deltaSeconds)\n//   );\n\n//   // Get the divisor to divide from the seconds. E.g. if our unit is \"day\" our divisor\n//   // is one day in seconds, so we can divide our seconds by this to get the # of days\n//   const divisor = unitIndex ? cutoffs[unitIndex - 1] : 1;\n\n//   // Intl.RelativeTimeFormat do its magic\n//   const rtf = new Intl.RelativeTimeFormat(lang, { numeric: \"auto\" });\n//   return rtf.format(Math.floor(deltaSeconds / divisor!), units[unitIndex]!);\n// }\n","import React, { useEffect } from \"react\";\nimport { usePlayer, useRound } from \"../hooks\";\n\nconst buttonStyle = {\n  width: 40,\n  height: 40,\n  backgroundColor: \"#888\",\n  color: \"black\",\n  verticalAlign: \"top\",\n  fontSize: \"32px\",\n  borderLeft: \"5px solid rgb(220,220,220)\",\n  borderTop: \"5px solid rgb(220,220,220)\",\n  borderBottom: \"5px solid #333\",\n  borderRight: \"5px solid #333\",\n  display: \"inline-block\",\n};\n\nconst visitStyle = {\n  width: 40,\n  height: 40,\n  itemsAlign: \"center\",\n  backgroundColor: \"#555\",\n  color: \"white\",\n  fontWeight: \"bold\",\n  border: \"1px solid black\",\n  verticalAlign: \"top\",\n  fontSize: \"24px\",\n  display: \"inline-block\",\n};\n\ntype cell = number | string;\ntype row = [cell, cell, cell, cell, cell, cell, cell, cell, cell, cell];\ntype grid = [row, row, row, row, row, row, row, row, row, row];\n\nexport function Sweeper() {\n  const round = useRound();\n  if (!round) {\n    return null;\n  }\n  const player = usePlayer();\n  if (!player) {\n    return null;\n  }\n\n  const visited = round.get(\"visited\") as Array<Array<number>>;\n  const bombs = round.get(\"bombs\") as Array<Array<number | \"X\">>;\n  const lost = round.get(\"lost\") as boolean;\n\n  useEffect(function () {\n    generateBombs();\n  }, []);\n\n  function generateBombs() {\n    if (bombs || !round) {\n      return;\n    }\n\n    let bombArr = new Array(10)\n      .fill(0)\n      .map(() => new Array(10).fill(0)) as grid;\n\n    for (let i = 0; i < bombArr.length; i++) {\n      let bombPos = Math.floor(Math.random() * 10);\n      bombArr[i]![bombPos] = \"X\";\n    }\n\n    for (let i = 0; i < bombArr.length; i++) {\n      for (let j = 0; j < bombArr[i]!.length; j++) {\n        if (bombArr[i]![j] !== \"X\") {\n          let sum = 0;\n\n          if (i > 0 && bombArr[i - 1]![j] == \"X\") sum++;\n          if (i < bombArr.length - 1 && bombArr[i + 1]![j] == \"X\") sum++;\n          if (j < bombArr.length - 1 && bombArr[i]![j + 1] == \"X\") sum++;\n          if (j > 0 && bombArr[i]![j - 1] == \"X\") sum++;\n          if (i < bombArr.length - 1 && j > 0 && bombArr[i + 1]![j - 1] == \"X\")\n            sum++;\n          if (\n            i < bombArr.length - 1 &&\n            j < bombArr.length - 1 &&\n            bombArr[i + 1]![j + 1] == \"X\"\n          )\n            sum++;\n          if (i > 0 && j > 0 && bombArr[i - 1]![j - 1] == \"X\") sum++;\n          if (i > 0 && j < bombArr.length - 1 && bombArr[i - 1]![j + 1] == \"X\")\n            sum++;\n\n          bombArr[i]![j] = sum;\n        }\n      }\n    }\n\n    round.set(\"bombs\", bombArr);\n\n    let cover = Array(10)\n      .fill(0)\n      .map(() => Array(10).fill(0));\n\n    round.set(\"visited\", cover);\n  }\n\n  const visitCell = (i: number, j: number) => {\n    if (lost || !bombs || !visited) {\n      return;\n    }\n\n    if (bombs[i]![j] === \"X\") {\n      round.set(\"lost\", true);\n    }\n\n    dfsCells(i, j);\n    visited[i]![j] = 1;\n    round.set(\"visited\", [...visited]);\n  };\n\n  function dfsCells(i: number, j: number) {\n    if (!round || !bombs || !visited) {\n      return;\n    }\n\n    if (\n      i < 0 ||\n      i > visited.length - 1 ||\n      j < 0 ||\n      j > visited[0]!.length - 1 ||\n      visited[i]![j] == 1 ||\n      bombs[i]![j] == \"X\"\n    )\n      return;\n\n    visited[i]![j] = 1;\n\n    round.set(\"visited\", [...visited]);\n\n    const cell = bombs[i]![j]!;\n    if (typeof cell === \"number\" && cell < 1) {\n      dfsCells(i + 1, j);\n      dfsCells(i - 1, j);\n      dfsCells(i, j + 1);\n      dfsCells(i, j - 1);\n    }\n  }\n\n  if (!bombs) {\n    return null;\n  }\n\n  return (\n    <div className=\"text-sm relative\">\n      {lost ? (\n        <>\n          <div className=\"absolute h-full w-full flex items-center justify-center text-6xl white font-black bg-opacity-50 bg-gray-300\">\n            YOU LOST\n          </div>\n          <div className=\"absolute h-full w-full flex items-center justify-center text-6xl white font-black mt-1 ml-1 text-white\">\n            YOU LOST\n          </div>\n        </>\n      ) : (\n        \"\"\n      )}\n\n      {bombs.map((arr, index) => (\n        <div key={index}>\n          {arr.map((_, i) => (\n            <div\n              key={i}\n              onClick={() => visitCell(index, i)}\n              style={visited[index]![i] == 0 ? buttonStyle : visitStyle}\n            >\n              <div className=\"h-full w-full flex items-center justify-center\">\n                {visited[index]![i] == 0\n                  ? null\n                  : bombs[index]![i] == 0\n                  ? \"\"\n                  : bombs[index]![i]}\n              </div>\n            </div>\n          ))}\n        </div>\n      ))}\n    </div>\n  );\n}\n"],"mappings":"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","names":["React","val","React","useEffect","useState","useState","useEffect","React","Step","React","Lobby","Finished","React","useState","React","useRef","React","useEffect","useRef","useState","React","useRef","useState","useEffect","React","useEffect","useEffect","React"]}